<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: file: https:; media-src 'self' file:; font-src 'self'; connect-src 'self' https://api.handsub.com; frame-src 'none'; object-src 'none'; base-uri 'self'; form-action 'none';">
  <title>handsub</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="titlebar">
    <div class="titlebar-left">
      <button id="listBtn" title="메모 목록">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m2 7h20a1 1 0 0 0 0-2h-20a1 1 0 0 0 0 2z"/><path d="m22 11h-20a1 1 0 0 0 0 2h20a1 1 0 0 0 0-2z"/><path d="m22 17h-20a1 1 0 0 0 0 2h20a1 1 0 0 0 0-2z"/></svg>
      </button>
    </div>
    <div class="titlebar-center">
      <span id="titlebar-date"></span>
    </div>
    <div class="titlebar-right">
      <button id="newBtn" title="새 메모">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
      </button>
      <div id="notification-bell-container">
        <button id="notificationBellBtn" title="알림">
          <svg viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"><path d="m14 26c-2.2 0-4-1.8-4-4h-3.6c-1.3 0-2.4-1.1-2.4-2.4 0-.6.3-1.3.7-1.7l.9-.9c.3-.3.4-.6.4-1v-4c0-4.1 3.1-7.4 7-7.9v-1.1c0-.6.4-1 1-1s1 .4 1 1v1.1c3.9.5 7 3.9 7 7.9v4c0 .4.1.7.4 1l.9.9c.5.5.7 1.1.7 1.7 0 1.3-1.1 2.4-2.4 2.4h-3.6c0 2.2-1.8 4-4 4zm-2-4c0 1.1.9 2 2 2s2-.9 2-2zm4.8-2h4.7c.2 0 .4-.2.4-.4 0-.1 0-.2-.1-.3l-.8-.9c-.6-.6-1-1.5-1-2.4v-4c0-3.3-2.7-6-6-6s-6 2.7-6 6v4c0 .9-.4 1.8-1 2.4l-.9.9c-.1.1-.1.2-.1.3 0 .2.2.4.4.4h4.7z"/></svg>
          <span id="notification-badge" class="notification-badge hidden">0</span>
        </button>
        <!-- 알림 드롭다운 -->
        <div id="notification-dropdown" class="notification-dropdown hidden">
          <div class="notification-dropdown-header">알림</div>
          <div id="notification-dropdown-list" class="notification-dropdown-list">
            <!-- 알림 항목들이 여기에 표시됨 -->
          </div>
          <div id="notification-dropdown-empty" class="notification-dropdown-empty">
            새로운 알림이 없습니다
          </div>
        </div>
      </div>
      <button id="closeBtn" title="닫기">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
      </button>
    </div>
  </div>
  <div id="sidebar">
    <div id="search-box">
      <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M505.749,475.587l-145.6-145.6c28.203-34.837,45.184-79.104,45.184-127.317c0-111.744-90.923-202.667-202.667-202.667S0,90.925,0,202.669s90.923,202.667,202.667,202.667c48.213,0,92.48-16.981,127.317-45.184l145.6,145.6c4.16,4.16,9.621,6.251,15.083,6.251s10.923-2.091,15.083-6.251C514.091,497.411,514.091,483.928,505.749,475.587z M202.667,362.669c-88.235,0-160-71.765-160-160s71.765-160,160-160s160,71.765,160,160S290.901,362.669,202.667,362.669z"/></svg>
      <input type="text" id="search-input" placeholder="검색...">
    </div>
    <div id="memo-list"></div>
    <div id="sidebar-resize"></div>
  </div>
  <div id="editor" contenteditable="true" autofocus></div>
  <div id="link-previews"></div>
  <div id="tool-log"></div>
  <div id="statusbar"></div>

  <!-- 전달 팝업 -->
  <div id="share-popup" class="share-popup hidden">
    <!-- Pro 잠금 오버레이 -->
    <div id="share-pro-lock" class="share-pro-lock hidden">
      <svg viewBox="0 0 512 512" fill="currentColor"><path d="M400,188h-36.037v-82.23c0-58.322-48.449-105.77-108-105.77c-59.551,0-108,47.448-108,105.77V188H112c-33.084,0-60,26.916-60,60v204c0,33.084,26.916,60,60,60h288c33.084,0,60-26.916,60-60V248C460,214.916,433.084,188,400,188z M187.963,105.77c0-36.266,30.505-65.77,68-65.77s68,29.504,68,65.77V188h-136V105.77z M420,452c0,11.028-8.972,20-20,20H112c-11.028,0-20-8.972-20-20V248c0-11.028,8.972-20,20-20h288c11.028,0,20,8.972,20,20V452z"/><path d="M256,286c-20.435,0-37,16.565-37,37c0,13.048,6.76,24.51,16.963,31.098V398c0,11.045,8.954,20,20,20c11.045,0,20-8.955,20-20v-43.855C286.207,347.565,293,336.08,293,323C293,302.565,276.435,286,256,286z"/></svg>
      <span>Pro</span>
    </div>
    <div class="share-popup-header">
      <span>메모 공유</span>
      <button id="share-popup-close" class="share-popup-close">&times;</button>
    </div>
    <!-- 메인 탭 (공유 / 게시) -->
    <div class="share-main-tabs">
      <button class="share-main-tab active" data-tab="share">공유</button>
      <button class="share-main-tab" data-tab="publish">게시</button>
    </div>
    <!-- 공유 탭 (참여자 + 초대) -->
    <div id="share-tab-share" class="share-tab-content">
      <div class="share-popup-content">
        <!-- 이메일 초대 -->
        <div class="share-input-row">
          <input type="email" id="share-email-input" placeholder="이메일 주소 입력..." autocomplete="email">
          <button id="share-send-btn" class="share-send-btn">초대</button>
        </div>
        <!-- 참여자 목록 -->
        <div id="share-members-list" class="share-members-list">
          <!-- 동적으로 참여자 목록 표시 -->
        </div>
      </div>
    </div>
    <!-- 게시 탭 (링크 공유) -->
    <div id="share-tab-publish" class="share-tab-content hidden">
      <div class="share-popup-content">
        <!-- 게시 전 -->
        <div id="share-link-create" class="share-link-create">
          <p class="publish-desc">이 메모를 웹에 게시하면<br>링크를 가진 누구나 볼 수 있습니다.</p>
          <button id="share-link-create-btn" class="share-send-btn full-width">게시</button>
        </div>
        <!-- 게시 후 -->
        <div id="share-link-result" class="share-link-result hidden">
          <div class="share-link-url-row">
            <input type="text" id="share-link-url" readonly>
            <button id="share-link-copy-btn" class="share-send-btn">복사</button>
          </div>
          <div class="publish-actions">
            <button id="share-link-view-btn" class="publish-action-btn">링크 보기</button>
            <button id="share-link-delete-btn" class="publish-action-btn">게시 취소</button>
          </div>
        </div>
      </div>
    </div>
    <div id="share-status" class="share-status hidden"></div>
  </div>

  <!-- 그룹 생성/편집 다이얼로그 (deprecated) -->
  <div id="group-dialog" class="group-dialog hidden">
    <div class="group-dialog-content">
      <div class="group-dialog-header">
        <span id="group-dialog-title">새 그룹</span>
        <button id="group-dialog-close" class="share-popup-close">&times;</button>
      </div>
      <div class="group-dialog-body">
        <input type="text" id="group-name-input" placeholder="그룹 이름..." maxlength="20">
        <div class="group-color-picker">
          <button class="group-color-btn selected" data-color="#007AFF" style="background:#007AFF"></button>
          <button class="group-color-btn" data-color="#34C759" style="background:#34C759"></button>
          <button class="group-color-btn" data-color="#FF9500" style="background:#FF9500"></button>
          <button class="group-color-btn" data-color="#FF3B30" style="background:#FF3B30"></button>
          <button class="group-color-btn" data-color="#AF52DE" style="background:#AF52DE"></button>
        </div>
      </div>
      <div class="group-dialog-footer">
        <button id="group-delete-btn" class="group-delete-btn hidden">삭제</button>
        <button id="group-save-btn" class="share-send-btn">저장</button>
      </div>
    </div>
  </div>

  <!-- 협업 참여자 목록 (상태바에 표시) -->
  <div id="collab-participants"></div>

  <!-- 협업 초대 다이얼로그 -->
  <div id="collab-invite-dialog" class="collab-invite-dialog hidden">
    <h3>협업 초대</h3>
    <input type="email" id="collab-invite-email" placeholder="초대할 이메일 주소...">
    <div class="collab-invite-actions">
      <button id="collab-invite-cancel" class="collab-btn">취소</button>
      <button id="collab-invite-send" class="share-send-btn">초대</button>
    </div>
  </div>

  <!-- 협업 세션 종료 확인 다이얼로그 -->
  <div id="collab-end-dialog" class="collab-invite-dialog hidden">
    <h3>협업 종료</h3>
    <p style="font-size: 12px; color: var(--memo-date-color); margin-bottom: 16px;">
      협업을 종료하면 다른 참여자들도 세션에서 나가게 됩니다.
    </p>
    <div class="collab-invite-actions">
      <button id="collab-end-cancel" class="collab-btn">취소</button>
      <button id="collab-end-confirm" class="share-send-btn" style="background: #FF3B30; border-color: #FF3B30;">종료</button>
    </div>
  </div>

  <script type="module" src="renderer/index.js"></script>
</body>
</html>
